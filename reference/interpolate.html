<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Make a SpatRaster with interpolated values using a fitted model object of classes such as "gstat" (gstat package) or "Krige" (fields package), or any other model that has location (e.g., "x" and "y", or "longitude" and "latitude") as predictors (independent variables). If x and y are the only predictors, it is most efficient if you provide an empty (no associated data in memory or on file) SpatRaster for which you want predictions. If there are more spatial predictor variables provide these as a SpatRaster in the first argument of the function. If you do not have x and y locations as implicit predictors in your model you should use predict instead.'><title>Spatial interpolation — interpolation • terra</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial interpolation — interpolation"><meta property="og:description" content='Make a SpatRaster with interpolated values using a fitted model object of classes such as "gstat" (gstat package) or "Krige" (fields package), or any other model that has location (e.g., "x" and "y", or "longitude" and "latitude") as predictors (independent variables). If x and y are the only predictors, it is most efficient if you provide an empty (no associated data in memory or on file) SpatRaster for which you want predictions. If there are more spatial predictor variables provide these as a SpatRaster in the first argument of the function. If you do not have x and y locations as implicit predictors in your model you should use predict instead.'><meta property="og:image" content="https://rspatial.github.io/terra/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">terra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-72</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../reference/terra-package.html">Description</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://rspatial.org">Tutorials</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rspatial/terra/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Spatial interpolation</h1>
      
      <div class="d-none name"><code>interpolate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Make a SpatRaster with interpolated values using a fitted model object of classes such as "gstat" (gstat package) or "Krige" (fields package), or any other model that has location (e.g., "x" and "y", or "longitude" and "latitude") as predictors (independent variables). If x and y are the only predictors, it is most efficient if you provide an empty (no associated data in memory or on file) SpatRaster for which you want predictions. If there are more spatial predictor variables provide these as a SpatRaster in the first argument of the function. If you do not have x and y locations as implicit predictors in your model you should use <code><a href="predict.html">predict</a></code> instead.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for SpatRaster</span></span>
<span><span class="fu">interpolate</span><span class="op">(</span><span class="va">object</span>, <span class="va">model</span>, fun<span class="op">=</span><span class="va">predict</span>, <span class="va">...</span>, xyNames<span class="op">=</span><span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, </span>
<span>       factors<span class="op">=</span><span class="cn">NULL</span>, const<span class="op">=</span><span class="cn">NULL</span>, index <span class="op">=</span> <span class="cn">NULL</span>, cores<span class="op">=</span><span class="fl">1</span>, cpkgs<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>     na.rm<span class="op">=</span><span class="cn">FALSE</span>, filename<span class="op">=</span><span class="st">""</span>, overwrite<span class="op">=</span><span class="cn">FALSE</span>, wopt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>SpatRaster</p></dd>

<dt>model</dt>
<dd><p>model object</p></dd>

<dt>fun</dt>
<dd><p>function. Default value is "predict", but can be replaced with e.g. "predict.se" (depending on the class of <code>model</code>), or a custom function (see examples)</p></dd>

<dt>...</dt>
<dd><p>additional arguments passed to <code>fun</code></p></dd>

<dt>xyNames</dt>
<dd><p>character. variable names that the model uses for the spatial coordinates. E.g., <code>c("longitude", "latitude")</code></p></dd>

 <dt>factors</dt>
<dd><p>list with levels for factor variables. The list elements should be named with names that correspond to names in <code>object</code> such that they can be matched. This argument may be omitted for some models from which the levels can be extracted from the <code>model</code> object</p></dd>

<dt>const</dt>
<dd><p>data.frame. Can be used to add a constant for which there is no SpatRaster for model predictions. This is particularly useful if the constant is a character-like factor value</p></dd>

  <dt>index</dt>
<dd><p>positive integer or NULL. Allows for selecting of the variable returned if the model returns multiple variables</p></dd>

 <dt>cores</dt>
<dd><p>positive integer. If <code>cores &gt; 1</code>, a 'parallel' package cluster with that many cores is created and used</p></dd>

  <dt>cpkgs</dt>
<dd><p>character. The package(s) that need to be loaded on the nodes to be able to run the model.predict function (see examples in <code><a href="predict.html">predict</a></code>)</p></dd>
  
 <dt>na.rm</dt>
<dd><p>logical. If <code>TRUE</code>, cells with <code>NA</code> values in the predictors are removed from the computation. This option prevents errors with models that cannot handle <code>NA</code> values. In most other cases this will not affect the output. An exception is when predicting with a model that returns predicted values even if some (or all!) variables are <code>NA</code></p></dd>


<dt>filename</dt>
<dd><p>character. Output filename</p></dd>

<dt>overwrite</dt>
<dd><p>logical. If <code>TRUE</code>, <code>filename</code> is overwritten</p></dd>

<dt>wopt</dt>
<dd><p>list with named options for writing files as in <code><a href="writeRaster.html">writeRaster</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>SpatRaster</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="predict.html">predict</a></code>, <code>link{interpIDW}</code>, <code>link{interpNear}</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="rast.html">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"ex/elev.tif"</span>, package<span class="op">=</span><span class="st">"terra"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ra</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">r</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="xyCellFrom.html">xyFromCell</a></span><span class="op">(</span><span class="va">ra</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="dimensions.html">ncell</a></span><span class="op">(</span><span class="va">ra</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="values.html">values</a></span><span class="op">(</span><span class="va">ra</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dnychka/fieldsRPackage" class="external-link">fields</a></span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">tps</span> <span class="op">&lt;-</span> <span class="fu">Tps</span><span class="op">(</span><span class="va">xy</span>, <span class="va">v</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="rast.html">rast</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use model to predict values at all locations</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">interpolate</span><span class="op">(</span><span class="va">p</span>, <span class="va">tps</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="mask.html">mask</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">r</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### change "fun" from predict to fields::predictSE to get the TPS standard error</span></span></span>
<span class="r-in"><span><span class="co">## need to use "rast(p)" to remove the values</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">interpolate</span><span class="op">(</span><span class="fu"><a href="rast.html">rast</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="va">tps</span>, fun<span class="op">=</span><span class="va">predictSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="mask.html">mask</a></span><span class="op">(</span><span class="va">se</span>, <span class="va">r</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### another predictor variable, "e"</span></span></span>
<span class="r-in"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="init.html">init</a></span><span class="op">(</span><span class="va">r</span>, <span class="st">"x"</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="init.html">init</a></span><span class="op">(</span><span class="va">r</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">100000000</span></span></span>
<span class="r-in"><span><span class="fu"><a href="names.html">names</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"e"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="coerce.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">e</span>, <span class="va">xy</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## add as another independent variable</span></span></span>
<span class="r-in"><span><span class="va">xyz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tps2</span> <span class="op">&lt;-</span> <span class="fu">Tps</span><span class="op">(</span><span class="va">xyz</span>, <span class="va">v</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">interpolate</span><span class="op">(</span><span class="va">e</span>, <span class="va">tps2</span>, xyOnly<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## as a linear coveriate</span></span></span>
<span class="r-in"><span><span class="va">tps3</span> <span class="op">&lt;-</span> <span class="fu">Tps</span><span class="op">(</span><span class="va">xy</span>, <span class="va">v</span>, Z<span class="op">=</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Z is a separate argument in Krig.predict, so we need a new function</span></span></span>
<span class="r-in"><span><span class="co">## Internally (in interpolate) a matrix is formed of x, y, and elev (Z)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pfun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="predict.html">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, Z<span class="op">=</span><span class="va">x</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, <span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">interpolate</span><span class="op">(</span><span class="va">e</span>, <span class="va">tps3</span>, fun<span class="op">=</span><span class="va">pfun</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### gstat examples</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/gstat/" class="external-link">gstat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### inverse distance weighted (IDW)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="rast.html">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"ex/meuse.tif"</span>, package<span class="op">=</span><span class="st">"terra"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mg</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"zinc"</span>, formula <span class="op">=</span> <span class="va">zinc</span><span class="op">~</span><span class="fl">1</span>, locations <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>, data<span class="op">=</span><span class="va">meuse</span>, </span></span>
<span class="r-in"><span>            nmax<span class="op">=</span><span class="fl">7</span>, set<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>idp <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">interpolate</span><span class="op">(</span><span class="va">r</span>, <span class="va">mg</span>, debug.level<span class="op">=</span><span class="fl">0</span>, index<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="mask.html">mask</a></span><span class="op">(</span><span class="va">z</span>, <span class="va">r</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with a model built with an `sf` object you need to provide custom function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sfmeuse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">meuse</span>, coords <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs<span class="op">=</span><span class="fu"><a href="crs.html">crs</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mgsf</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"zinc"</span>, formula <span class="op">=</span> <span class="va">zinc</span><span class="op">~</span><span class="fl">1</span>, data<span class="op">=</span><span class="va">sfmeuse</span>,  nmax<span class="op">=</span><span class="fl">7</span>, set<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>idp <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">interpolate_gstat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">x</span>, <span class="va">crs</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">x</span>, coords<span class="op">=</span><span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs<span class="op">=</span><span class="va">crs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict.html">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">v</span>, <span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">zsf</span> <span class="op">&lt;-</span> <span class="fu">interpolate</span><span class="op">(</span><span class="va">r</span>, <span class="va">mgsf</span>, debug.level<span class="op">=</span><span class="fl">0</span>, fun<span class="op">=</span><span class="va">interpolate_gstat</span>, crs<span class="op">=</span><span class="fu"><a href="crs.html">crs</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, index<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zsf</span> <span class="op">&lt;-</span> <span class="fu"><a href="mask.html">mask</a></span><span class="op">(</span><span class="va">zsf</span>, <span class="va">r</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### kriging</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### ordinary kriging</span></span></span>
<span class="r-in"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu">variogram</span><span class="op">(</span><span class="fu"><a href="math-generics.html">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>, data<span class="op">=</span><span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mv</span> <span class="op">&lt;-</span> <span class="fu">fit.variogram</span><span class="op">(</span><span class="va">v</span>, <span class="fu">vgm</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Sph"</span>, <span class="fl">300</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gOK</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span><span class="cn">NULL</span>, <span class="st">"log.zinc"</span>, <span class="fu"><a href="math-generics.html">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, locations<span class="op">=</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>, model<span class="op">=</span><span class="va">mv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">OK</span> <span class="op">&lt;-</span> <span class="fu">interpolate</span><span class="op">(</span><span class="va">r</span>, <span class="va">gOK</span>, debug.level<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## universal kriging</span></span></span>
<span class="r-in"><span><span class="va">vu</span> <span class="op">&lt;-</span> <span class="fu">variogram</span><span class="op">(</span><span class="fu"><a href="math-generics.html">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="va">elev</span>, <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>, data<span class="op">=</span><span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu">fit.variogram</span><span class="op">(</span><span class="va">vu</span>, <span class="fu">vgm</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Sph"</span>, <span class="fl">300</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gUK</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span><span class="cn">NULL</span>, <span class="st">"log.zinc"</span>, <span class="fu"><a href="math-generics.html">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="va">elev</span>, <span class="va">meuse</span>, locations<span class="op">=</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>, model<span class="op">=</span><span class="va">mu</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="names.html">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"elev"</span></span></span>
<span class="r-in"><span><span class="va">UK</span> <span class="op">&lt;-</span> <span class="fu">interpolate</span><span class="op">(</span><span class="va">r</span>, <span class="va">gUK</span>, debug.level<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## co-kriging</span></span></span>
<span class="r-in"><span><span class="va">gCoK</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span><span class="cn">NULL</span>, <span class="st">'log.zinc'</span>, <span class="fu"><a href="math-generics.html">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, locations<span class="op">=</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gCoK</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span><span class="va">gCoK</span>, <span class="st">'elev'</span>, <span class="va">elev</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, locations<span class="op">=</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gCoK</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span><span class="va">gCoK</span>, <span class="st">'cadmium'</span>, <span class="va">cadmium</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, locations<span class="op">=</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gCoK</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span><span class="va">gCoK</span>, <span class="st">'copper'</span>, <span class="va">copper</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, locations<span class="op">=</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coV</span> <span class="op">&lt;-</span> <span class="fu">variogram</span><span class="op">(</span><span class="va">gCoK</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">coV</span>, type<span class="op">=</span><span class="st">'b'</span>, main<span class="op">=</span><span class="st">'Co-variogram'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coV.fit</span> <span class="op">&lt;-</span> <span class="fu">fit.lmc</span><span class="op">(</span><span class="va">coV</span>, <span class="va">gCoK</span>, <span class="fu">vgm</span><span class="op">(</span>model<span class="op">=</span><span class="st">'Sph'</span>, range<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coV.fit</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">coV</span>, <span class="va">coV.fit</span>, main<span class="op">=</span><span class="st">'Fitted Co-variogram'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coK</span> <span class="op">&lt;-</span> <span class="fu">interpolate</span><span class="op">(</span><span class="va">r</span>, <span class="va">coV.fit</span>, debug.level<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">coK</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Robert J. Hijmans.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

